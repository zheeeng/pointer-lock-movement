import{r as D}from"./index.a9e6f4fc.js";var J=Object.defineProperty,K=Object.defineProperties,Q=Object.getOwnPropertyDescriptors,k=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable,j=(e,r,t)=>r in e?J(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,z=(e,r)=>{for(var t in r||(r={}))W.call(r,t)&&j(e,t,r[t]);if(k)for(var t of k(r))R.call(r,t)&&j(e,t,r[t]);return e},U=(e,r)=>K(e,Q(r)),Z=(e,r)=>{var t={};for(var a in e)W.call(e,a)&&r.indexOf(a)<0&&(t[a]=e[a]);if(e!=null&&k)for(var a of k(e))r.indexOf(a)<0&&R.call(e,a)&&(t[a]=e[a]);return t},b;function ee(e,{zIndex:r}={}){if(!e)return{width:window.innerWidth,height:window.innerHeight,x:0,y:0};if(e instanceof DOMRect)return{width:e.width,height:e.height,x:e.x,y:e.y};const t=e instanceof HTMLElement?e:document.createElement("div");typeof e=="object"&&e!==null&&!(e instanceof HTMLElement)&&Object.assign(t.style,e),t.style.position="fixed",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.top=t.style.top||"0px",t.style.left=t.style.left||"0px",t.style.width=t.style.width||"0px",t.style.height=t.style.height||"0px",r!==void 0&&(t.style.zIndex=r.toString()),b=t,document.body.appendChild(t);const{width:a,height:Y,x:X,y:M}=t.getBoundingClientRect();return{width:a,height:Y,x:X,y:M}}function te(){b==null||b.remove(),b=void 0}var _;function ne(e,{zIndex:r}={}){const t=document.createElement("div"),a=document.createElement("div");return t.appendChild(a),e instanceof HTMLElement?a.appendChild(e):typeof e=="string"?a.textContent=e:typeof e=="object"&&e!==null&&Object.assign(a.style,e),t.style.position="fixed",t.style.top="0px",t.style.left="0px",a.style.transform="translate(-50%, -50%)",r!==void 0&&(t.style.zIndex=r.toString()),_=t,document.body.appendChild(t),t}function ie(){_==null||_.remove(),_=void 0}var O=8,q=2;function re(){return"pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document}function oe(){if(!re())throw new Error("Your browser does not support pointer lock")}var se=(e,r={})=>{var t=r,{loopBehavior:a="loop",trigger:Y="drag",zIndex:X=99999}=t,M=Z(t,["loopBehavior","trigger","zIndex"]);const o=U(z({},M),{loopBehavior:a,trigger:Y,zIndex:X});function T(){var i,s;((s=(i=e.requestPointerLock)!=null?i:e.mozRequestPointerLock)!=null?s:e.webkitRequestPointerLock).call(e)}function B(){var i,s;((s=(i=document.exitPointerLock)!=null?i:document.mozExitPointerLock)!=null?s:document.webkitExitPointerLock).call(document)}function x(){return e===document.pointerLockElement||e===document.mozPointerLockElement||e===document.webkitPointerLockElement}const A=(i,s)=>m=>{let{movementX:u,movementY:p}=m;const f=[...i.historyX,u].slice(-O),v=[...i.historyY,p].slice(-O);if(f.length===O&&v.length===O){const y=f.reduce((d,c)=>d+c,0)/f.length,L=v.reduce((d,c)=>d+c,0)/v.length,h=Math.sqrt(f.reduce((d,c)=>d+Math.pow(c-y,2),0)/f.length),n=Math.sqrt(v.reduce((d,c)=>d+Math.pow(c-L,2),0)/v.length);h>0&&Math.abs(u-y)/h>q&&(u=y),n>0&&Math.abs(p-L)/n>q&&(p=L)}const l={event:m,movementX:u,movementY:p,x:i.x+i.movementX,y:i.y+i.movementY,historyX:f,historyY:v,status:"moving"};o.loopBehavior==="loop"?(l.x>i.maxWidth?l.x-=i.maxWidth:l.x<0&&(l.x+=i.maxWidth),l.y>i.maxHeight?l.y-=i.maxHeight:l.y<0&&(l.y+=i.maxHeight)):o.loopBehavior==="stop"&&(l.x>i.maxWidth?(l.x=i.maxWidth,i.status="stopped"):l.x<0&&(l.x=0,l.status="stopped"),l.y>i.maxHeight?(l.y=i.maxHeight,i.status="stopped"):l.y<0&&(l.y=0,l.status="stopped"));const E=z(z({},i),l);return s(E),E.event.defaultPrevented?A(i,s):A(E,s)};function S(){let i;const s={targetOnActiveElement:!1,isDetecting:!1,startX:0,startY:0};function m(n){!(n instanceof PointerEvent)||!n.buttons||!o.dragOffset||Math.sqrt(Math.pow(n.clientX-s.startX,2)+Math.pow(n.clientY-s.startY,2))<o.dragOffset||(e.removeEventListener("pointermove",m),s.isDetecting=!1,f(n))}function u(){var n;B(),(n=o.onLock)==null||n.call(o,!1),document.removeEventListener("pointermove",p),i=void 0,ie(),te()}function p(n){o.trigger==="drag"&&!n.buttons?u():v(n)}function f(n){var d;const c=ee(o.screen,{zIndex:o.zIndex}),P=ne(o.cursor,{zIndex:o.zIndex});i=A({event:n,status:"moving",startX:n.clientX,startY:n.clientY,movementX:0,movementY:0,historyX:[],historyY:[],x:n.clientX-c.x,y:n.clientY-c.y,maxWidth:c.width,maxHeight:c.height},({event:w,status:N,x:H,y:C,startX:V,startY:F,movementX:$,movementY:G})=>{var I;P.style.transform=`translate3D(${H}px, ${C}px, 0px)`,(I=o.onMove)==null||I.call(o,w,{status:N,offsetX:H-V,offsetY:C-F,movementX:$,movementY:G})})(n),document.addEventListener("pointermove",p),document.addEventListener("pointerlockchange",function w(){x()||(document.removeEventListener("pointerlockchange",w),u())}),(d=o.onLock)==null||d.call(o,!0),T()}function v(n){i=i==null?void 0:i(n)}function g(){!x()||u()}function l(n){x()||f(n)}function E(n){!(n instanceof PointerEvent)||n.button!==0||s.targetOnActiveElement&&o.disableOnActiveElement||l(n)}function y(n){!(n instanceof PointerEvent)||n.button!==0||(x()?g():l(n))}function L(n){var d;!(n instanceof PointerEvent)||n.button!==0||!o.dragOffset||s.targetOnActiveElement&&o.disableOnActiveElement||x()||((d=o==null?void 0:o.onPrepareLock)==null||d.call(o,n),s.isDetecting=!0,s.startX=n.clientX,s.startY=n.clientY,e.addEventListener("pointermove",m),e.addEventListener("pointerup",function c(P){var w;s.isDetecting&&P instanceof PointerEvent&&((w=o==null?void 0:o.onCancelPrepareLock)==null||w.call(o,P)),e.removeEventListener("pointerup",c),e.removeEventListener("pointermove",m),s.isDetecting=!1}))}function h(n){!(n instanceof PointerEvent)||n.button!==0||!o.disableOnActiveElement||(n.target===document.activeElement?s.targetOnActiveElement=!0:s.targetOnActiveElement=!1)}return oe(),o.disableOnActiveElement&&e.addEventListener("pointerdown",h),o.trigger==="drag"?o.dragOffset?(e.addEventListener("pointerdown",L),document.addEventListener("pointerup",g),()=>{e.removeEventListener("pointermove",L),document.removeEventListener("pointerup",g),e.removeEventListener("pointerdown",h)}):(e.addEventListener("pointerdown",E),document.addEventListener("pointerup",g),()=>{e.removeEventListener("pointerdown",E),document.removeEventListener("pointerup",g),e.removeEventListener("pointerdown",h)}):(e.addEventListener("pointerdown",y),()=>{e.removeEventListener("pointerdown",y),e.removeEventListener("pointerdown",h)})}return S()};const le=e=>{const r=D.exports.useRef(null);return D.exports.useLayoutEffect(()=>{r.current=e}),D.exports.useCallback((...t)=>{var a;return(a=r.current)==null?void 0:a.call(r,...t)},[])};export{se as p,le as u};
